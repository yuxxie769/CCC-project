(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43925dfa"],{"4bb4":function(e,t,i){"use strict";i.r(t);i("b0c0");var n=i("7a23"),r=Object(n["C"])("data-v-4966d55e");Object(n["s"])("data-v-4966d55e");var o={class:"datamap view"},s=Object(n["g"])("div",{id:"map"},null,-1),a={id:"legend"},c={class:"title"},l=Object(n["g"])("div",{id:"legendColors"},null,-1),u={class:"footer"},d={class:"container"},h={class:"filters"},g={class:"input-group"},p=Object(n["g"])("label",{class:"input-group-text",for:"sel_pla"},"Place",-1),f={class:"input-group"},v=Object(n["g"])("label",{class:"input-group-text",for:"sel_sce"},"Twitter Data",-1),b={class:"input-group"},m=Object(n["g"])("label",{class:"input-group-text",for:"sel_aur"},"Aurin Data",-1);Object(n["q"])();var y=r((function(e,t,i,r,y,w){return Object(n["p"])(),Object(n["d"])("div",o,[s,Object(n["g"])("div",a,[Object(n["g"])("div",c,Object(n["y"])(w.legendTitle),1),l]),Object(n["g"])("div",u,[Object(n["g"])("div",d,[Object(n["g"])("div",h,[Object(n["g"])("div",g,[p,Object(n["g"])("select",{class:"form-select",id:"sel_pla",onChange:t[1]||(t[1]=function(e){return w.switchPlace(e)})},[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.places,(function(e){return Object(n["p"])(),Object(n["d"])("option",{key:e,value:e.n},Object(n["y"])(e.name),9,["value"])})),128))],32)]),Object(n["g"])("div",f,[v,Object(n["g"])("select",{class:"form-select",id:"sel_sce",onChange:t[2]||(t[2]=function(e){return w.switchScenario(e)})},[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.scenarios,(function(e){return Object(n["p"])(),Object(n["d"])("option",{key:e},Object(n["y"])(e),1)})),128))],32)]),Object(n["g"])("div",b,[m,Object(n["g"])("select",{class:"form-select",id:"sel_aur",onChange:t[3]||(t[3]=function(e){return w.switchAurin(e)})},[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.aurins,(function(e){return Object(n["p"])(),Object(n["d"])("option",{key:e},Object(n["y"])(e),1)})),128))],32)])])])])])})),w=(i("d81d"),i("159b"),i("99af"),function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var n,r,o;if(Array.isArray(t)){if(n=t.length,n!=i.length)return!1;for(r=n;0!==r--;)if(!e(t[r],i[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(i).length)return!1;for(r=n;0!==r--;)if(!Object.prototype.hasOwnProperty.call(i,o[r]))return!1;for(r=n;0!==r--;){var s=o[r];if(!e(t[s],i[s]))return!1}return!0}return t!==t&&i!==i});const O="__googleMapsScriptId";class j{constructor({apiKey:e,channel:t,client:i,id:n=O,libraries:r=[],language:o,region:s,version:a,mapIds:c,nonce:l,retries:u=3,url:d="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=a,this.apiKey=e,this.channel=t,this.client=i,this.id=n||O,this.libraries=r,this.language=o,this.region=s,this.mapIds=c,this.nonce=l,this.retries=u,this.url=d,j.instance){if(!w(this.options,j.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(j.instance.options)}`);return j.instance}j.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback="+this.CALLBACK,this.apiKey&&(e+="&key="+this.apiKey),this.channel&&(e+="&channel="+this.channel),this.client&&(e+="&client="+this.client),this.libraries.length>0&&(e+="&libraries="+this.libraries.join(",")),this.language&&(e+="&language="+this.language),this.region&&(e+="&region="+this.region),this.version&&(e+="&v="+this.version),this.mapIds&&(e+="&map_ids="+this.mapIds.join(",")),e}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(i=>{i?t(i):e()})})}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=e,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}var k=i("313e"),C={setup:function(){},data:function(){return{currentPlace:null,currentScenario:null,currentAurin:null,max:-1/0,min:1/0}},computed:{legendTitle:function(){return"Income"===this.currentAurin?"Median Income ($)":"Obesity"===this.currentAurin?"Obesity Rate (%)":this.currentAurin}},beforeMount:function(){var e=this;this.initData();var t=new j({apiKey:"AIzaSyDUqi5MIFYKvXj3ZDUkpjS5PjiT-5ohFko",version:"weekly"});t.load().then((function(){console.log("AIzaSyDUqi5MIFYKvXj3ZDUkpjS5PjiT-5ohFko");var t=window.google,i=new t.maps.Map(document.getElementById("map"),{styles:e.$store.state.silver_map,streetViewControl:!1});e.map=window.map=i,e.switchPlace("vic"),e.setColor(),e.infowindow=new window.google.maps.InfoWindow,i.data.addListener("click",(function(t){e.createInfoWindow(i,t)})),i.data.addListener("mouseover",(function(e){i.data.revertStyle(),i.data.overrideStyle(e.feature,{strokeColor:"grey",strokeWeight:4})})),i.data.addListener("mouseout",(function(){i.data.revertStyle()}))}))},mounted:function(){this.currentScenario=document.getElementById("sel_sce").value,this.currentAurin=document.getElementById("sel_aur").value,this.changeLegend()},methods:{initData:function(){this.places=this.$store.state.places,this.scenarios=this.$store.state.scenarios,this.aurins=this.$store.state.aurins,this.google=window.google},clearMap:function(){var e,t=this.map;null===(e=this.infowindow)||void 0===e||e.close(),t.data.forEach((function(e){t.data.remove(e)}))},switchPlace:function(e){var t;this.clearMap();var i=(null===(t=e.target)||void 0===t?void 0:t.value)||e,n=this.places[i],r=n.coords,o=n.zoom,s=n.filename,a=this.map,c="http://172.26.132.191:5000/"+s;this.currentPlace=this.places[i],a.setZoom(o),a.setCenter(r),a.data.loadGeoJson(c)},switchScenario:function(e){this.currentScenario=e.target.value,this.infowindow.close()},switchAurin:function(e){this.currentAurin=e.target.value,this.infowindow.close(),this.setColor()},createInfoWindow:function(e,t){var i=t.feature.getProperty(this.currentPlace.placeField),n=t.feature.getProperty("bitcoin_tweets_count"),r=t.feature.getProperty("traffic_tweets_count"),o=t.feature.getProperty("exercise_tweets_count"),s=t.feature.getProperty("income_2014"),a=t.feature.getProperty("obesity_rate"),c=t.feature.getProperty("population"),l='<div id="obesityPieChart" style="height:240px;width:300px;"></div>',u="<div>Tweets related to Bitcoin: ".concat(n,"</div>"),d="<div>Tweets related to traffic: ".concat(r,"</div>"),h="<div>Tweets related to exercise: ".concat(o,"</div>"),g="<div>Income: ".concat(s,"</div>"),p='<div id="content">\n            <div id="siteNotice">'.concat(this.currentPlace.name,'</div>\n            <h5 id="firstHeading" class="firstHeading">').concat(i,'</h5>\n            <div id="bodyContent">\n              ').concat("Bitcoin"===this.currentScenario?u:"","\n              ").concat("Traffic"===this.currentScenario?d:"","\n              ").concat("Exercise"===this.currentScenario?h:"","\n              Population: ").concat(c,"\n              ").concat("Income"===this.currentAurin?g:"","\n              ").concat(a&&"Obesity"===this.currentAurin?l:"","\n            </div>\n           </div>"),f=new window.google.maps.LatLngBounds,v=t.feature.getGeometry();v.forEachLatLng((function(e){f.extend({lat:e.lat(),lng:e.lng()})}));var b=f.getCenter(),m=new window.google.maps.Marker({position:b,map:e,visible:!1});this.infowindow.setContent(p),this.infowindow.open(e,m),a&&"Obesity"===this.currentAurin&&setTimeout((function(){var e,t=document.getElementById("obesityPieChart"),i=k["a"](t);e={tooltip:{trigger:"item"},legend:{top:"0%",left:"center"},series:[{name:"Obesity Rate",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:"{d}%"},emphasis:{},labelLine:{show:!0},data:[{value:a,name:"Obesity"},{value:c-a,name:"Other"}]}]},e&&i.setOption(e)}),0)},getIncomeFill:function(e){var t=this.$store.state.income_color;return void 0===e?"grey":e<=3e4?t[0]:e>=6e4?t[t.length-1]:t[1+((e-3e4)/2500>>0)]},getPopulationFill:function(e){if(void 0===e)return"grey";var t=e>36e4?"50%":90-4*(e/36e3>>0);return"hsl(40deg 100% ".concat(t,"%)")},getObesityFill:function(e,t){if(void 0===e||e>t)return"grey";var i=e/t,n=i>.35?.35:80-4*((i-.1)/.025>>0);return"hsl(210deg 60% ".concat(n,"%)")},setColor:function(){var e=this;this.changeLegend(),this.map.data.setStyle((function(t){var i,n=t.getProperty("population"),r=t.getProperty("income_2014"),o=t.getProperty("obesity_rate");return"Population"===e.currentAurin?i=e.getPopulationFill(n):"Income"===e.currentAurin?i=e.getIncomeFill(r):"Obesity"===e.currentAurin&&(i=e.getObesityFill(o,n)),{fillColor:i,fillOpacity:.7,strokeColor:i,strokeWeight:1}}))},changeLegend:function(){var e,t=document.getElementById("legendColors");if(t.innerHTML="","Income"===this.currentAurin){e=this.$store.state.income_color;for(var i=0;i<e.length;i++){var n=void 0;n=0===i?"> 60000":i===e.length-1?"< 30000":6e4-2500*i,this.createColor("".concat(e[e.length-i-1],"b3"),n)}}else if("Population"===this.currentAurin)for(var r=0;r<10;r++){var o=36e4-36e3*r,s=90-o/36e3*4;this.createColor("hsl(40deg 100% ".concat(s,"% / 70%)"),o,"#666")}else if("Obesity"===this.currentAurin)for(var a=0;a<10;a++){var c=.35-.025*a,l=80-c/.025*4;this.createColor("hsl(210deg 60% ".concat(l,"% / 70%)"),Math.round(100*c),"#fff")}},createColor:function(e,t,i){var n=document.getElementById("legendColors"),r=document.createElement("div");r.className="subColor",r.style.background=e;var o='style="color: '.concat(i,'; text-shadow:none"');r.innerHTML='<span class="value"'.concat(i?o:"",">").concat(t,"<span>"),n.appendChild(r)}}};i("a44f"),i("c081");C.render=y,C.__scopeId="data-v-4966d55e";t["default"]=C},"8ee8":function(e,t,i){},a44f:function(e,t,i){"use strict";i("c881")},c081:function(e,t,i){"use strict";i("8ee8")},c881:function(e,t,i){},d81d:function(e,t,i){"use strict";var n=i("23e7"),r=i("b727").map,o=i("1dde"),s=o("map");n({target:"Array",proto:!0,forced:!s},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-43925dfa.1f9bf159.js.map